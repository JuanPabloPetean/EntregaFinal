{% extends 'base.html' %}

{% block title %}Obras - Teatro Proyecto{% endblock %}

{% block content %}
<div class="container">
    <h1>Obras de Teatro</h1>
    
    {% if user.is_authenticated %}
        <p><a href="{% url 'crear_obra' %}" class="btn">+ Crear Nueva Obra</a></p>
    {% else %}
        <p><a href="{% url 'login' %}" class="btn">Inicia Sesión para Crear</a></p>
    {% endif %}
    
    {% if obras %}
        <div style="margin-top: 2rem;">
            {% for obra in obras %}
                <div style="background: white; border: 1px solid #ddd; padding: 1rem; margin: 1rem 0; border-radius: 8px;">
                    {% if obra.imagen %}
                        <img src="{{ obra.imagen.url }}" alt="{{ obra.titulo }}" style="max-width: 150px; height: auto; margin-right: 1rem; float: left; border-radius: 4px;">
                    {% endif %}
                    
                    <h2><a href="{% url 'obra_detail' obra.pk %}" style="color: #3498db; text-decoration: none;">{{ obra.titulo }}</a></h2>
                    <p><strong>Autor:</strong> {{ obra.autor }}</p>
                    <p><strong>Género:</strong> {{ obra.genero }}</p>
                    <p><strong>Fecha de Estreno:</strong> {{ obra.fecha_estreno|date:"d/m/Y" }}</p>
                    <p>{{ obra.descripcion|truncatewords:30 }}</p>
                    
                    <div style="clear: both; margin-top: 1rem;">
                        <a href="{% url 'obra_detail' obra.pk %}" class="btn">Ver Detalle</a>
                        {% if user.is_authenticated %}
                            <a href="{% url 'editar_obra' obra.pk %}" class="btn">Editar</a>
                            <a href="{% url 'eliminar_obra' obra.pk %}" class="btn btn-danger">Eliminar</a>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="background: #f0f0f0; padding: 2rem; text-align: center; border-radius: 8px; margin-top: 2rem;">
            <p style="font-size: 1.1rem; color: #666;">No hay obras registradas aún.</p>
            {% if user.is_authenticated %}
                <a href="{% url 'crear_obra' %}" class="btn">Crea la Primera Obra</a>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}
